(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{380:function(t,a,s){"use strict";s.r(a);var v=s(42),e=Object(v.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"xxsç›¸å…³"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xxsç›¸å…³"}},[t._v("#")]),t._v(" XXSç›¸å…³")]),t._v(" "),s("p",[t._v("XSSæ˜¯Crossing-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬ï¼‰ç®€å†™ï¼Œå®ƒæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ï¼Œæ”»å‡»è€…å¯ä»¥å¾€ Web é¡µé¢é‡Œæ’å…¥æ¶æ„ä»£ç ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆè¯¥ç½‘é¡µçš„æ—¶å€™ï¼ŒåµŒå…¥webé‡Œé¢çš„ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ”»å‡»è€…ç‰¹æ®Šç›®çš„ã€‚ç›®çš„å¯ä»¥æœ‰å¤šç§ï¼Œæ¯”å¦‚ï¼šç ´åç½‘ç«™ï¼Œå¯¼è‡´é¡µé¢ä¸å¯ç”¨ï¼Œæ”»å‡»æœåŠ¡ç«¯ï¼Œå¯¼è‡´æœåŠ¡æ‹’ç»ï¼Œçªƒå–ç”¨æˆ·cookieï¼Œå‘é€æ¶æ„è¯·æ±‚ï¼Œå®‰è£…é”®ç›˜è®°å½•å™¨ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œè·³è½¬é’“é±¼é¡µé¢ï¼Œçªƒå–è´¦å·å¯†ç ç­‰ç­‰ã€‚")]),t._v(" "),s("p",[t._v("XSSè§¦å‘çš„æ¡ä»¶åŒ…æ‹¬ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("æ”»å‡»è€…å¯ä»¥æäº¤æ¶æ„æ•°æ®")]),t._v(" "),s("li",[t._v("æ•°æ®æ²¡æœ‰è¢«å¤„ç†ï¼Œç›´æ¥å±•ç¤ºåˆ°é¡µé¢ä¸Šï¼ˆæ ‡ç­¾ã€æ ‡ç­¾å±æ€§ã€æ ‡ç­¾äº‹ä»¶ï¼‰")]),t._v(" "),s("li",[t._v("å…¶ä»–ç”¨æˆ·å¯ä»¥è®¿é—®è¯¥é¡µé¢")])]),t._v(" "),s("h2",{attrs:{id:"xxsçš„åˆ†ç±»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xxsçš„åˆ†ç±»"}},[t._v("#")]),t._v(" XXSçš„åˆ†ç±»")]),t._v(" "),s("p",[t._v("åå°„å‹ã€å­˜å‚¨å‹ã€Dom Basedå‹")]),t._v(" "),s("h3",{attrs:{id:"åå°„å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åå°„å‹"}},[t._v("#")]),t._v(" åå°„å‹")]),t._v(" "),s("p",[t._v("å…¸å‹æ­¥éª¤")]),t._v(" "),s("ol",[s("li",[t._v("æ”»å‡»è€…æ„é€ å‡ºåŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šçš„URL")]),t._v(" "),s("li",[t._v("ç”¨æˆ·ç™»é™†åï¼Œè®¿é—®å¸¦æœ‰æ¶æ„ä»£ç çš„URL")]),t._v(" "),s("li",[t._v("æœåŠ¡ç«¯å–å‡ºURLä¸Šçš„æ¶æ„ä»£ç ï¼Œæ‹¼æ¥åœ¨HTMLä¸­è¿”å›æµè§ˆå™¨")]),t._v(" "),s("li",[t._v("ç”¨æˆ·æµè§ˆå™¨æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œæ··å…¥å…¶ä¸­çš„æ¶æ„ä»£ç \n5.çªƒå–æ•æ„Ÿä¿¡æ¯/å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œå®ŒæˆXSSæ”»å‡»")])]),t._v(" "),s("p",[t._v("å¸¸è§åœºæ™¯")]),t._v(" "),s("p",[t._v("é€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚ç½‘ç«™æœç´¢ã€è·³è½¬ç­‰")]),t._v(" "),s("p",[t._v("åŒºåˆ«/ç‰¹ç‚¹")]),t._v(" "),s("ol",[s("li",[t._v("éæŒä¹…å‹xssæ”»å‡»ï¼Œä¾èµ–äºæœåŠ¡å™¨å¯¹æ¶æ„è¯·æ±‚çš„åå°„ï¼Œä»…å¯¹å½“æ¬¡çš„é¡µé¢è®¿é—®äº§ç”Ÿå½±å“")]),t._v(" "),s("li",[t._v("æ¶æ„ä»£ç å­˜åœ¨URLä¸Š")]),t._v(" "),s("li",[t._v("ç»è¿‡åç«¯ï¼Œä¸ç»è¿‡æ•°æ®åº“")])]),t._v(" "),s("h3",{attrs:{id:"å­˜å‚¨å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å­˜å‚¨å‹"}},[t._v("#")]),t._v(" å­˜å‚¨å‹")]),t._v(" "),s("p",[t._v("å…¸å‹æ­¥éª¤")]),t._v(" "),s("ol",[s("li",[t._v("æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­")]),t._v(" "),s("li",[t._v("ç”¨æˆ·ç™»é™†åï¼Œè®¿é—®ç›¸å…³é¡µé¢URL")]),t._v(" "),s("li",[t._v("æœåŠ¡ç«¯ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„ä»£ç ï¼Œæ‹¼æ¥åœ¨HTMLä¸­è¿”å›æµè§ˆå™¨")]),t._v(" "),s("li",[t._v("ç”¨æˆ·æµè§ˆå™¨æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œæ··å…¥å…¶ä¸­çš„æ¶æ„ä»£ç ")]),t._v(" "),s("li",[t._v("çªƒå–æ•æ„Ÿä¿¡æ¯/å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œå®ŒæˆXSSæ”»å‡»")])]),t._v(" "),s("p",[t._v("å¸¸è§åœºæ™¯")]),t._v(" "),s("p",[t._v("å¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œæ¯”å¦‚è®ºå›å‘å¸–ã€å•†å“è¯„ä»·ã€ç”¨æˆ·ç§ä¿¡ç­‰ç­‰ã€‚")]),t._v(" "),s("p",[t._v("åŒºåˆ«/ç‰¹ç‚¹")]),t._v(" "),s("ol",[s("li",[t._v("æŒä¹…å‹xssï¼Œæ”»å‡»è€…çš„æ•°æ®ä¼šå­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œæ”»å‡»è¡Œä¸ºå°†ä¼´éšç€æ”»å‡»æ•°æ®ä¸€ç›´å­˜åœ¨ã€‚")]),t._v(" "),s("li",[t._v("æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“")]),t._v(" "),s("li",[t._v("ç»è¿‡åç«¯ï¼Œç»è¿‡æ•°æ®åº“")])]),t._v(" "),s("h3",{attrs:{id:"domå‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#domå‹"}},[t._v("#")]),t._v(" DOMå‹")]),t._v(" "),s("p",[t._v("å…¸å‹æ­¥éª¤")]),t._v(" "),s("ol",[s("li",[t._v("å‰ç«¯ JavaScript å–å‡º URLä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§è¡Œ")]),t._v(" "),s("li",[t._v("çªƒå–æ•æ„Ÿä¿¡æ¯/å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œå®ŒæˆXSSæ”»å‡»")])]),t._v(" "),s("p",[t._v("å¸¸è§åœºæ™¯")]),t._v(" "),s("p",[t._v("é¡µé¢JSè·å–æ•°æ®åä¸åšç”„åˆ«ï¼Œç›´æ¥æ“ä½œDOMã€‚ä¸€èˆ¬è§äºä»URLã€cookieã€LocalStorageä¸­å–å†…å®¹çš„åœºæ™¯")]),t._v(" "),s("p",[t._v("åŒºåˆ«/ç‰¹ç‚¹")]),t._v(" "),s("ol",[s("li",[t._v("å–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯ JavaScript è‡ªèº«çš„å®‰å…¨æ¼æ´")])]),t._v(" "),s("h2",{attrs:{id:"å¦‚ä½•é˜²å¾¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•é˜²å¾¡"}},[t._v("#")]),t._v(" å¦‚ä½•é˜²å¾¡")]),t._v(" "),s("h3",{attrs:{id:"é’ˆå¯¹åå°„å’Œå­˜å‚¨å‹xss"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é’ˆå¯¹åå°„å’Œå­˜å‚¨å‹xss"}},[t._v("#")]),t._v(" é’ˆå¯¹åå°„å’Œå­˜å‚¨å‹XSS")]),t._v(" "),s("p",[t._v("å­˜å‚¨å‹å’Œåå°„å‹ XSS éƒ½æ˜¯åœ¨åç«¯å–å‡ºæ¶æ„ä»£ç åï¼Œæ’å…¥åˆ°å“åº” HTML é‡Œçš„ï¼Œé¢„é˜²è¿™ç§æ¼æ´ä¸»è¦æ˜¯å…³æ³¨åç«¯çš„å¤„ç†ã€‚")]),t._v(" "),s("h4",{attrs:{id:"åç«¯è®¾ç½®ç™½åå•ï¼Œå‡€åŒ–æ•°æ®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åç«¯è®¾ç½®ç™½åå•ï¼Œå‡€åŒ–æ•°æ®"}},[t._v("#")]),t._v(" åç«¯è®¾ç½®ç™½åå•ï¼Œå‡€åŒ–æ•°æ®")]),t._v(" "),s("p",[t._v("åç«¯å¯¹äºä¿å­˜/è¾“å‡ºçš„æ•°æ®è¦è¿›è¡Œè¿‡æ»¤å’Œè½¬ä¹‰ï¼Œè¿‡æ»¤çš„å†…å®¹ï¼šæ¯”å¦‚locationã€onclickã€onerrorã€onloadã€onmouseover ã€  script ã€href ã€ evalã€setTimeoutã€setIntervalç­‰ï¼Œå¸¸è§æ¡†æ¶ï¼šbluemondayï¼Œjsoupç­‰")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("String unsafe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"<p><a href='http://example.com/' onclick='stealCookies()'>Link</a></p>\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nString safe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Jsoup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("clean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("unsafe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Whitelist"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("basic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// now: <p><a href="http://example.com/" >Link</a></p>')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"é¿å…æ‹¼æ¥-htmlï¼Œé‡‡ç”¨çº¯å‰ç«¯æ¸²æŸ“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¿å…æ‹¼æ¥-htmlï¼Œé‡‡ç”¨çº¯å‰ç«¯æ¸²æŸ“"}},[t._v("#")]),t._v(" é¿å…æ‹¼æ¥ HTMLï¼Œé‡‡ç”¨çº¯å‰ç«¯æ¸²æŸ“")]),t._v(" "),s("p",[t._v("æµè§ˆå™¨å…ˆåŠ è½½ä¸€ä¸ªé™æ€ HTMLï¼Œåç»­é€šè¿‡ Ajax åŠ è½½ä¸šåŠ¡æ•°æ®ï¼Œè°ƒç”¨ DOM API æ›´æ–°åˆ°é¡µé¢ä¸Šã€‚çº¯å‰ç«¯æ¸²æŸ“è¿˜éœ€æ³¨æ„é¿å… DOM å‹ XSS æ¼æ´")]),t._v(" "),s("h3",{attrs:{id:"é’ˆå¯¹domå‹xss"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é’ˆå¯¹domå‹xss"}},[t._v("#")]),t._v(" é’ˆå¯¹DOMå‹XSS")]),t._v(" "),s("p",[t._v("DOM å‹ XSS æ”»å‡»ï¼Œå®é™…ä¸Šå°±æ˜¯ç½‘ç«™å‰ç«¯ JavaScript ä»£ç æœ¬èº«ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„æ•°æ®å½“ä½œä»£ç æ‰§è¡Œäº†ã€‚")]),t._v(" "),s("h4",{attrs:{id:"è°¨æ…å¯¹å¾…å±•ç¤ºæ•°æ®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è°¨æ…å¯¹å¾…å±•ç¤ºæ•°æ®"}},[t._v("#")]),t._v(" è°¨æ…å¯¹å¾…å±•ç¤ºæ•°æ®")]),t._v(" "),s("p",[t._v("è°¨æ…ä½¿ç”¨.innerHTMLã€.outerHTMLã€document.write() ï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸º HTML æ’åˆ°é¡µé¢ä¸Šã€‚\nDOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ locationã€onclickã€onerrorã€onloadã€onmouseover ç­‰ï¼Œ"),s("code",[t._v("<a>")]),t._v(" æ ‡ç­¾çš„ href å±æ€§ï¼ŒJavaScript çš„ eval()ã€setTimeout()ã€setInterval() ç­‰ï¼Œéƒ½èƒ½æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿå®‰å…¨éšæ‚£ï¼Œè°¨æ…å¤„ç†ä¼ é€’ç»™è¿™äº› APIçš„å­—ç¬¦ä¸²ã€‚")]),t._v(" "),s("h4",{attrs:{id:"æ•°æ®å……åˆ†è½¬ä¹‰ï¼Œè¿‡æ»¤æ¶æ„ä»£ç "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®å……åˆ†è½¬ä¹‰ï¼Œè¿‡æ»¤æ¶æ„ä»£ç "}},[t._v("#")]),t._v(" æ•°æ®å……åˆ†è½¬ä¹‰ï¼Œè¿‡æ»¤æ¶æ„ä»£ç ")]),t._v(" "),s("p",[t._v("å¯ä»¥ä½¿ç”¨ä¸€äº›æ’ä»¶ xss.jsï¼ŒDOMPurify")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ”¾ç½®ä½ç½®")]),t._v(" "),s("th",[t._v("ä¾‹å­")]),t._v(" "),s("th",[t._v("é‡‡å–çš„ç¼–ç ")]),t._v(" "),s("th",[t._v("ç¼–ç æ ¼å¼")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("HTMLæ ‡ç­¾ä¹‹é—´")]),t._v(" "),s("td",[s("code",[t._v("<div> ä¸å¯ä¿¡æ•°æ® </div>")])]),t._v(" "),s("td",[t._v("HTML Entityç¼–ç ")]),t._v(" "),s("td",[t._v("& â€“> & < â€“> < > â€“> > â€ â€“> \" â€˜ â€“> ' / â€“> /")])]),t._v(" "),s("tr",[s("td",[t._v("HTMLæ ‡ç­¾çš„å±æ€§")]),t._v(" "),s("td",[s("code",[t._v("<input type=â€textâ€value=â€ ä¸å¯ä¿¡æ•°æ® â€ />")])]),t._v(" "),s("td",[t._v("HTML Attributeç¼–ç ")]),t._v(" "),s("td",[t._v("&#xHH")])]),t._v(" "),s("tr",[s("td",[t._v("JavaScript")]),t._v(" "),s("td",[s("code",[t._v("<script> var msg = â€ ä¸å¯ä¿¡æ•°æ® â€ <\/script>")])]),t._v(" "),s("td",[t._v("JavaScriptç¼–ç ")]),t._v(" "),s("td",[t._v("\\xHH")])]),t._v(" "),s("tr",[s("td",[t._v("CSS")]),t._v(" "),s("td",[s("code",[t._v("<div style=â€ width: ä¸å¯ä¿¡æ•°æ® â€ > â€¦ </div>")])]),t._v(" "),s("td",[t._v("CSSç¼–ç ")]),t._v(" "),s("td",[t._v("\\HH")])]),t._v(" "),s("tr",[s("td",[t._v("URLå‚æ•°ä¸­")]),t._v(" "),s("td",[s("code",[t._v("<a href=â€/page?p= ä¸å¯ä¿¡æ•°æ® â€ >â€¦</a>")])]),t._v(" "),s("td",[t._v("URLç¼–ç ")]),t._v(" "),s("td",[t._v("%HH")])])])]),t._v(" "),s("p",[t._v("ç¼–ç è§„åˆ™ï¼šé™¤äº†é˜¿æ‹‰ä¼¯æ•°å­—å’Œå­—æ¯ï¼Œå¯¹å…¶ä»–æ‰€æœ‰çš„å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œåªè¦è¯¥å­—ç¬¦çš„ASCIIç å°äº256ã€‚ç¼–ç åè¾“å‡ºçš„æ ¼å¼ä¸ºä»¥ä¸Šç¼–ç æ ¼å¼ ï¼ˆä»¥&#xã€\\x ã€\\ã€%å¼€å¤´ï¼ŒHHåˆ™æ˜¯æŒ‡è¯¥å­—ç¬¦å¯¹åº”çš„åå…­è¿›åˆ¶æ•°å­—ï¼‰")]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼"}},[t._v("#")]),t._v(" ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼")]),t._v(" "),s("p",[t._v("é‡‡ç”¨vue/react/angularç­‰æŠ€æœ¯æ ˆæ—¶ï¼Œä½¿ç”¨æ’å€¼è¡¨è¾¾å¼ï¼Œé¿å…ä½¿ç”¨v-htmlã€‚å› ä¸ºtemplateè½¬æˆrender functionçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæŠŠæ’å€¼è¡¨è¾¾å¼ä½œä¸ºTextæ–‡æœ¬å†…å®¹è¿›è¡Œæ¸²æŸ“ã€‚åœ¨å‰ç«¯ render é˜¶æ®µé¿å… innerHTMLã€outerHTML çš„ XSS éšæ‚£ã€‚")]),t._v(" "),s("p",[t._v("æ¯”å¦‚ï¼š")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{item}}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("æœ€ç»ˆç”Ÿæˆçš„ä»£ç å¦‚ä¸‹")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"with(this){return _c('div',{staticClass:\"")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"},[_c('span',[_v(_s(item))])])}\"")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("_c æ˜¯ createElement ç®€å†™ï¼Œå³ render å‡½æ•°ï¼Œ_v æ˜¯ createTextVNode çš„ç®€å†™ï¼Œåˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹ï¼Œ_s æ˜¯ toString ç®€å†™")]),t._v(" "),s("h3",{attrs:{id:"å…¶ä»–æªæ–½"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…¶ä»–æªæ–½"}},[t._v("#")]),t._v(" å…¶ä»–æªæ–½")]),t._v(" "),s("ul",[s("li",[t._v("è®¾ç½®Cookie httpOnly")])]),t._v(" "),s("p",[t._v("ç¦æ­¢ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookieï¼Œæ”»å‡»è€…å®Œæˆ XSS æ³¨å…¥åä¹Ÿæ— æ³•çªƒå–æ­¤ Cookie")]),t._v(" "),s("ul",[s("li",[t._v("è®¾ç½®CSPï¼ˆContent Security Policyï¼‰")])]),t._v(" "),s("p",[t._v("CSP çš„å®è´¨å°±æ˜¯è®¾ç½®æµè§ˆå™¨ç™½åå•ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œï¼Œè‡ªåŠ¨ç¦æ­¢å¤–éƒ¨æ³¨å…¥æ¶æ„è„šæœ¬ã€‚")]),t._v(" "),s("p",[t._v("CSPå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥å¼€å¯ ï¼š")]),t._v(" "),s("p",[t._v("1.è®¾ç½®htmlçš„ meta æ ‡ç­¾çš„æ–¹å¼")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Security-Policy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("script-src 'self' *.baidu.com ; style-src 'self' ;"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("2.è®¾ç½® HTTP Header ä¸­çš„ Content-Security-Policy")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  Content-Security-Policy: script-src 'self' *.baidu.com ; style-src 'self' ;\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("ä¸Šè¿°ä»£ç æè¿°çš„CSPè§„åˆ™æ˜¯jsè„šæœ¬åªèƒ½æ¥è‡ªå½“å‰åŸŸåå’Œbaidu.comäºŒçº§åŸŸåä¸‹ï¼Œcssåªèƒ½æ¥è‡ªå½“å‰åŸŸå")]),t._v(" "),s("p",[t._v("CSPå¯ä»¥é™åˆ¶åŠ è½½èµ„æºçš„ç±»å‹ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("key")]),t._v(" "),s("th",[t._v("å«ä¹‰")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("script-src")]),t._v(" "),s("td",[t._v("å¤–éƒ¨è„šæœ¬")])]),t._v(" "),s("tr",[s("td",[t._v("style-src")]),t._v(" "),s("td",[t._v("æ ·å¼è¡¨")])]),t._v(" "),s("tr",[s("td",[t._v("img-src")]),t._v(" "),s("td",[t._v("å›¾åƒ")])]),t._v(" "),s("tr",[s("td",[t._v("media-src")]),t._v(" "),s("td",[t._v("åª’ä½“æ–‡ä»¶ï¼ˆéŸ³é¢‘å’Œè§†é¢‘ï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("font-src")]),t._v(" "),s("td",[t._v("å­—ä½“æ–‡ä»¶")])]),t._v(" "),s("tr",[s("td",[t._v("object-src")]),t._v(" "),s("td",[t._v("æ’ä»¶ï¼ˆæ¯”å¦‚ Flashï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("child-src")]),t._v(" "),s("td",[t._v("æ¡†æ¶")])]),t._v(" "),s("tr",[s("td",[t._v("frame-ancestors")]),t._v(" "),s("td",[t._v("åµŒå…¥çš„å¤–éƒ¨èµ„æºï¼ˆæ¯”å¦‚"),s("code",[t._v("<frame>ã€<iframe>ã€<embed>å’Œ<applet>")]),t._v("ï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("connect-src")]),t._v(" "),s("td",[t._v("HTTP è¿æ¥ï¼ˆé€šè¿‡ XHRã€WebSocketsã€EventSourceç­‰ï¼‰worker-srcworkerè„šæœ¬")])]),t._v(" "),s("tr",[s("td",[t._v("manifest-src")]),t._v(" "),s("td",[t._v("manifest æ–‡ä»¶")])]),t._v(" "),s("tr",[s("td",[t._v("default-src")]),t._v(" "),s("td",[t._v("ç”¨æ¥è®¾ç½®ä¸Šé¢å„ä¸ªé€‰é¡¹çš„é»˜è®¤å€¼")])])])]),t._v(" "),s("p",[t._v("åŒæ—¶ä¹Ÿå¯è®¾ç½®èµ„æºçš„é™åˆ¶è§„åˆ™")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å¯é€‰å€¼")]),t._v(" "),s("th",[t._v("ä¾‹å­")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ä¸»æœºå")]),t._v(" "),s("td",[t._v("example.orgï¼Œ"),s("code",[t._v("https://example.com:443")])])]),t._v(" "),s("tr",[s("td",[t._v("è·¯å¾„å")]),t._v(" "),s("td",[t._v("example.org/resources/js/")])]),t._v(" "),s("tr",[s("td",[t._v("é€šé…ç¬¦")]),t._v(" "),s("td",[s("em",[t._v(".example.orgï¼Œ")]),t._v("ğŸ˜•/"),s("em",[t._v(".example.com:")]),t._v("ï¼ˆè¡¨ç¤ºä»»æ„åè®®ã€ä»»æ„å­åŸŸåã€ä»»æ„ç«¯å£ï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("åè®®å")]),t._v(" "),s("td",[t._v("https:ã€data:")])]),t._v(" "),s("tr",[s("td",[t._v("'self'")]),t._v(" "),s("td",[t._v("å½“å‰åŸŸåï¼Œéœ€è¦åŠ å¼•å·")])]),t._v(" "),s("tr",[s("td",[t._v("'none'")]),t._v(" "),s("td",[t._v("ç¦æ­¢åŠ è½½ä»»ä½•å¤–éƒ¨èµ„æºï¼Œéœ€è¦åŠ å¼•å·")])]),t._v(" "),s("tr",[s("td",[t._v("'unsafe-inline'")]),t._v(" "),s("td",[t._v("å…è®¸æ‰§è¡Œé¡µé¢å†…åµŒçš„"),s("code",[t._v("<script>")]),t._v("æ ‡ç­¾å’Œäº‹ä»¶ç›‘å¬å‡½æ•°")])]),t._v(" "),s("tr",[s("td",[t._v("'unsafe-eval'")]),t._v(" "),s("td",[t._v("å…è®¸å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ‰§è¡Œï¼Œæ¯”å¦‚ä½¿ç”¨evalã€setTimeoutã€setIntervalå’ŒFunctionç­‰å‡½æ•°")])])])]),t._v(" "),s("p",[t._v("ä¸¥æ ¼çš„ CSP åœ¨ XSS çš„é˜²èŒƒä¸­å¯ä»¥èµ·åˆ°ä»¥ä¸‹çš„ä½œç”¨ï¼š")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("ç¦æ­¢åŠ è½½å¤–åŸŸä»£ç ï¼Œé˜²æ­¢å¤æ‚çš„æ”»å‡»é€»è¾‘")])]),t._v(" "),s("li",[s("p",[t._v("ç¦æ­¢å¤–åŸŸæäº¤ï¼Œç½‘ç«™è¢«æ”»å‡»åï¼Œç”¨æˆ·çš„æ•°æ®ä¸ä¼šæ³„éœ²åˆ°å¤–åŸŸ")])]),t._v(" "),s("li",[s("p",[t._v("ç¦æ­¢å†…è”è„šæœ¬æ‰§è¡Œ")])]),t._v(" "),s("li",[s("p",[t._v("ç¦æ­¢æœªæˆæƒçš„è„šæœ¬æ‰§è¡Œ")])]),t._v(" "),s("li",[s("p",[t._v("è¾“å…¥å†…å®¹é•¿åº¦ã€ç±»å‹çš„æ§åˆ¶")])])]),t._v(" "),s("p",[t._v("å¯¹äºä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œéƒ½åº”è¯¥é™å®šä¸€ä¸ªåˆç†çš„é•¿åº¦ï¼Œå¹¶ä¸”å¯¹è¾“å…¥å†…å®¹çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒï¼ˆä¾‹å¦‚è¾“å…¥emailçš„æ–‡æœ¬æ¡†åªå…è®¸è¾“å…¥æ ¼å¼æ­£ç¡®çš„emailï¼Œè¾“å…¥æ‰‹æœºå·ç çš„æ–‡æœ¬æ¡†åªå…è®¸å¡«å…¥æ•°å­—ä¸”æ ¼å¼éœ€è¦æ­£ç¡®ï¼‰ã€‚è™½ç„¶æ— æ³•å®Œå…¨é˜²æ­¢ XSS å‘ç”Ÿï¼Œä½†å¯ä»¥å¢åŠ  XSS æ”»å‡»çš„éš¾åº¦ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("éªŒè¯ç ï¼Œé˜²æ­¢è„šæœ¬å†’å……ç”¨æˆ·æäº¤å±é™©æ“ä½œ")])]),t._v(" "),s("h2",{attrs:{id:"å¦‚ä½•æ£€æµ‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•æ£€æµ‹"}},[t._v("#")]),t._v(" å¦‚ä½•æ£€æµ‹")]),t._v(" "),s("ul",[s("li",[t._v("ä½¿ç”¨é€šç”¨ XSS æ”»å‡»å­—ç¬¦ä¸²æ‰‹åŠ¨æ£€æµ‹ XSS æ¼æ´")])]),t._v(" "),s("p",[t._v("å¼•ç”¨è‡ª"),s("a",{attrs:{href:"https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot",target:"_blank",rel:"noopener noreferrer"}},[t._v("Unleashing an Ultimate XSS Polyglot"),s("OutboundLink")],1),t._v("ï¼Œåªè¦åœ¨ç½‘ç«™çš„å„è¾“å…¥æ¡†ä¸­æäº¤è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…æŠŠå®ƒæ‹¼æ¥åˆ° URL å‚æ•°ä¸Šï¼Œå°±å¯ä»¥è¿›è¡Œæ£€æµ‹äº†ã€‚")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("jaVasCript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*-/*`/*\\`/*'/*\"/**/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* */")]),t._v("oNcliCk"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/<\/scRipt/--!>\\x3csVg/<sVg/oNloAd=alert()//>\\x3e")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("ä½¿ç”¨æ‰«æå·¥å…·è‡ªåŠ¨æ£€æµ‹ XSS æ¼æ´ï¼ˆBeEFã€w3af ã€ noXssç­‰ï¼‰")])])])}),[],!1,null,null,null);a.default=e.exports}}]);